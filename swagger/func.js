function strip_tags(str,allowed_tags){var key="",allowed=!1,matches=[],allowed_array=[],allowed_tag="",i=0,k="",html="",replacer=function(search,replace,str){return str.split(search).join(replace)};for(key in allowed_tags&&(allowed_array=allowed_tags.match(/([a-zA-Z]+)/gi)),matches=(str+="").match(/(<\/?[\S][^>]*>)/gi))if(!isNaN(key)){for(k in html=matches[key].toString(),allowed=!1,allowed_array)if(allowed_tag=allowed_array[k],0!=(i=-1)&&(i=html.toLowerCase().indexOf("<"+allowed_tag+">")),0!=i&&(i=html.toLowerCase().indexOf("<"+allowed_tag+" ")),0!=i&&(i=html.toLowerCase().indexOf("</"+allowed_tag)),0==i){allowed=!0;break}allowed||(str=replacer(html,"",str))}return str}function expandTextarea(id){document.getElementById(id).addEventListener("keyup",function(){this.style.overflow="hidden",this.style.height=0,this.style.height=this.scrollHeight+"px"},!1)}function setEndOfContenteditable(contentEditableElement){var range,selection;document.createRange?((range=document.createRange()).selectNodeContents(contentEditableElement),range.collapse(!1),(selection=window.getSelection()).removeAllRanges(),selection.addRange(range)):document.selection&&((range=document.body.createTextRange()).moveToElementText(contentEditableElement),range.collapse(!1),range.select())}function sleep(ms){return new Promise(resolve=>setTimeout(resolve,ms))}function addClass(elems,className,parent=null){if(null===parent)elems=document.querySelectorAll(elems);else elems=document.querySelector(parent).querySelectorAll(elems);[].forEach.call(elems,function(el){el.classList.add(className)})}function removeClass(elems,className,parent=null){if(null===parent)elems=document.querySelectorAll(elems);else elems=document.querySelector(parent).querySelectorAll(elems);[].forEach.call(elems,function(el){el.classList.remove(className)})}function timeName(time){var now=new Date;now=new Date(now.setHours(0,0,0,0));var yesterday=new Date(now.getTime()-864e5),dby=new Date(yesterday.getTime()-864e5);myDate=time.split(".");var newDate=new Date(myDate[2],myDate[1]-1,myDate[0]);return now.getTime()===newDate.getTime()?time="Сегодня":yesterday.getTime()===newDate.getTime()?time="Вчера":dby.getTime()===newDate.getTime()&&(time="Позавчера"),time}function slideToggle(elem){if(void 0!==elem.data&&!0===elem.data.slided)elem.removeAttribute("style"),elem.data={slided:!1};else{let height=elem.firstChild.getBoundingClientRect().height;elem.style.height=`${height+5}px`,elem.data={slided:!0}}}function fadeOut(el){el&&(el.style.opacity=1,function fade(){(el.style.opacity-=.1)<0?el.style.display="none":requestAnimationFrame(fade)}())}function fadeIn(el,display){el&&(el.style.opacity=0,el.style.display=display||"block",function fade(){var val=parseFloat(el.style.opacity);(val+=.1)>1||(el.style.opacity=val,requestAnimationFrame(fade))}())}let slideUp=(target,duration=500)=>{target.style.transitionProperty="height, margin, padding",target.style.transitionDuration=duration+"ms",target.style.height=target.offsetHeight+"px",target.offsetHeight,target.style.overflow="hidden",target.style.height=0,target.style.paddingTop=0,target.style.paddingBottom=0,target.style.marginTop=0,target.style.marginBottom=0,window.setTimeout(()=>{target.style.display="none",target.style.removeProperty("height"),target.style.removeProperty("padding-top"),target.style.removeProperty("padding-bottom"),target.style.removeProperty("margin-top"),target.style.removeProperty("margin-bottom"),target.style.removeProperty("overflow"),target.style.removeProperty("transition-duration"),target.style.removeProperty("transition-property")},duration)},slideDown=(target,duration=500,trg)=>{if("none"===target.style.display)target.style.display="",target.style.removeProperty("display");else{getStyleSheetPropertyValue(target.id?"#"+target.id:target.classList[0]?"."+target.classList[0]:"undefined","display")}let height=target.offsetHeight;target.style.overflow="hidden",target.style.height=0,target.style.paddingTop=0,target.style.paddingBottom=0,target.style.marginTop=0,target.style.marginBottom=0,target.offsetHeight,target.style.transitionProperty="height, margin, padding",target.style.transitionDuration=duration+"ms",target.style.height=height+"px",target.style.removeProperty("padding-top"),target.style.removeProperty("padding-bottom"),target.style.removeProperty("margin-top"),target.style.removeProperty("margin-bottom"),window.setTimeout(()=>{target.style.removeProperty("height"),target.style.removeProperty("overflow"),target.style.removeProperty("transition-duration"),target.style.removeProperty("transition-property")},duration)};var slideToggler=(target,duration=500)=>"none"===window.getComputedStyle(target).display?slideDown(target,duration):slideUp(target,duration);function getStyleSheetPropertyValue(selectorText,propertyName){for(var s=window.document.styleSheets.length-1;s>=0;s--){try{var cssRules=document.styleSheets[s].cssRules||window.document.styleSheets[s].rules}catch(e){continue}for(var c=0;c<cssRules.length;c++)if(cssRules[c].selectorText===selectorText&&""!=cssRules[c].style[propertyName])return document.querySelector(selectorText).data=[[s],cssRules[c].style[propertyName],propertyName],cssRules[c].style[propertyName]&&cssRules[c].style.removeProperty(propertyName)}return null}function getHeight(el){if(!el)return 0;let s=window.getComputedStyle(el,null);return el.clientHeight-parseFloat(s.getPropertyValue("padding-top"))-parseFloat(s.getPropertyValue("padding-bottom"))}function isVisible(el){return!!el&&null!==el.offsetParent}function checkLimit(id,length){var el=document.querySelector(id),text=el.innerText||el.value,handler=function(e){text.length>length&&(modalTemplate.id="modal-limit-text",modalBody.innerText="Количество символов превышено!",document.querySelector(".ok").innerText="Ok",document.getElementById("modal-limit-text").addEventListener("hidden.bs.modal",function(){el.value=text.substr(0,length),el.textContent=text.substr(0,length),el.focus()}),modalToggle("#modal-limit-text")),el.removeEventListener("keydown",handler),el.removeEventListener("paste",handler),checkLimit(id,length)};el.addEventListener("keydown",handler),el.addEventListener("paste",handler)}function modalToggle(el){return bootstrap.Modal.getInstance(document.querySelector(el))?void bootstrap.Modal.getInstance(document.querySelector(el)).toggle():void new bootstrap.Modal(document.querySelector(el),{keyboard:!1}).toggle()}function detectMobile(){return!!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}function getKeyByValue(object,value){return Object.keys(object).find(key=>object[key]===value)}